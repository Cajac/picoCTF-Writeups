# Power Cookie

- [Challenge information](#challenge-information)
- [Solution](#solution)
- [References](#references)

## Challenge information
```
Points: 200
Tags: picoCTF 2022, Web Exploitation, cookie
Author: LT 'SYREAL' JONES

Description:
Can you get the flag?
Go to this website and see what you can discover.

Hints:
1. Do you know how to modify cookies?
```

## Solution

### Browse to the web site

Browse to the web site and we get a webpage titled `Online Gradebook`.  
On the page there is a `Continue as guest`-button.  
Press the button and we redirected to `/check.php` where the text `We apologize, but we have no guest services at the moment.` is shown.

From the challenge description we know that the root of the website is at `/usr/share/nginx/html/` and the flag is at `/flag.txt`.  
Relative to the web root the flag is at `../../../../flag.txt`. Lets try to read it.

### Check for cookies

Press F12 to open DevTools and go to the `Application` tab.  
Under `Storage` and then `Cookies` select the web site.  
Note that there is a cookie named `isAdmin` with the value of `0`.

### Get the flag in the browser

Set the cookie to 1 and reload the web page by pressing `F5` to get the flag.

### Get the flag with curl

Now that we have all the information we need to get the flag we can automate it with `curl` and `grep`
```bash
┌──(kali㉿kali)-[/mnt/…/picoCTF/picoCTF_2022/Web_Exploitation/Power_Cookie]
└─$ curl -s --cookie "isAdmin=1" http://saturn.picoctf.net:63041/check.php | grep -oE 'picoCTF{.*}'
picoCTF{<REDACTED>}
```

For additional information, please see the references below.

## References

- [curl - Linux manual page](https://man7.org/linux/man-pages/man1/curl.1.html)
- [grep - Linux manual page](https://man7.org/linux/man-pages/man1/grep.1.html)
- [Wikipedia - HTTP cookie](https://en.wikipedia.org/wiki/HTTP_cookie)
